// Initialize your map (assuming you have a map variable defined)
const map = L.map('map').setView([latitude, longitude], zoomLevel); // Set initial view

// Load the LGA boundaries
fetch('LGA_boundary.json')
    .then(response => response.json())
    .then(boundaryData => {
        // Load the PHC data
        return fetch('PHC_data.json'); // Adjust this path to your actual PHC file
    })
    .then(response => response.json())
    .then(phcData => {
        // Create a layer for the boundaries
        L.geoJSON(boundaryData, {
            onEachFeature: function (feature, layer) {
                // Add a click event to each boundary
                layer.on('click', function (e) {
                    const lat = e.latlng.lat;
                    const lng = e.latlng.lng;

                    // Find LGA based on the clicked point
                    const lgas = findLGAs(lat, lng, phcData);
                    displayLGAs(lgas);
                });
            }
        }).addTo(map);
    })
    .catch(error => console.error('Error loading data:', error));

// Function to find LGAs based on clicked coordinates
function findLGAs(lat, lng, phcData) {
    const lgas = new Set();

    phcData.forEach(item => {
        const facilityLat = item.properties.Latitude;
        const facilityLng = item.properties.Longitude;

        // Check if clicked coordinates are close to any facility (within a certain distance)
        if (Math.abs(facilityLat - lat) < 0.01 && Math.abs(facilityLng - lng) < 0.01) {
            lgas.add(item.properties.LGA); // Add LGA name to the set
        }
    });

    return Array.from(lgas); // Convert the set back to an array
}

// Function to display the LGA names
function displayLGAs(lgas) {
    let displayText = 'Local Governments:\n';

    lgas.forEach(lga => {
        displayText += `- ${lga}\n`;
    });

    // Display the information (adjust the HTML element as needed)
    document.getElementById('lga-display').innerText = displayText;
}
